<div class="breadcrumb-area breadcrumb-area-padding-2 bg-gray-2">
  <div class="custom-container">
    <div class="breadcrumb-content text-center">
      <ul>
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/shop">Shop</a>
        </li>
        <li class="active"><%= title  %> </li>
      </ul>
    </div>
  </div>
</div>
<div class="shop-area pt-75 pb-55">
  <div class="custom-container">
    <div class="row flex-row-reverse">
      <div class="col-lg-9">
        <% if(products.length > 0){ %>
        <div class="shop-topbar-wrapper">
          <div class="totall-product">
            <p> We found <span><%= foundrecords  %> </span> products available for you</p>
          </div>
          <div class="sort-by-product-area">
            <div class="sort-by-product-wrap">
              <div class="sort-by">
                <span><i class="far fa-align-left"></i>Sort by:</span>
              </div>
              <div class="sort-by-dropdown-wrap">
                <span>
                  <% if(filter === 'low'){ %>
                  Price: low to high
                  <% }else if(filter === 'high'){ %>
                  Price: high to low
                  <% }else if(filter === 'latest'){ %>
                  Latest
                  <% }else{ %>
                  Default
                  <% } %>
                  <i class="far fa-angle-down"></i>
                </span>
              </div>
            </div>
            <div class="sort-by-dropdown">
              <ul>
                <li><a class="<%= (filter == '') ? 'active' : '' %>" onclick="window.location.href= window.location.pathname">Default</a></li>
                <li><a class="<%= (filter === 'latest') ? 'active' : '' %>" onclick="window.location.href= window.location.pathname+'?filter=latest'">Latest</a></li>
                <li><a class="<%= (filter === 'low') ? 'active' : '' %>" onclick="window.location.href= window.location.pathname+'?filter=low'">Price: low to high</a></li>
                <li><a class="<%= (filter == 'high') ? 'active' : '' %>" onclick="window.location.href= window.location.pathname+'?filter=high'">Price: high to low</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="shop-bottom-area">
          <div class="row">
            <% if (products) { %>
            <% products.forEach(product => { %>
            <div class="col-xl-3 col-lg-4 col-md-4 col-12 col-sm-6 wow tmFadeInUp">
              <div class="single-product-wrap mb-50">
                <div class="product-img-action-wrap mb-10">
                  <div class="product-img product-img-zoom">
                    <a href="/shop/product/<%=  product.slug %>">
                      <img class="default-img" src="/uploads/<%= product.image  %> " alt="">
                      <img class="hover-img" src="/images/product/product-4-2.jpg" alt="">
                    </a>
                  </div>
                  <div class="product-action-1">
                    <button style="text-align: center;" aria-label="Add To Cart" id="add-to-cart-button" onclick="addToCart('<%= product._id %>')"><i class="far fa-shopping-bag"></i></button>
                    <button style="text-align: center;" aria-label="Add To Wishlist" onclick="addToWishList('<%= product._id %>')"><i class="far fa-heart"></i></button>
                  </div>
                  <div class="product-badges product-badges-position product-badges-mrg">
                    <span class="<%= (product.stock == true) ? 'success-2' : 'red-2'  %>"><%= (product.stock == true) ? 'In-Stock' : 'Out of Stock'  %></span>
                  </div>
                </div>
                <div class="product-content-wrap">
                  <div class="product-category">
                    <a href="/shop/category/<%= product.category.slug %>">
                      <%= maincat.title %>
                    </a>
                  </div>
                  <h2><a href="/shop/product/<%=  product.slug %>"><%= product.title  %> </a></h2>
                  <div class="product-price">
                    <span class="new-price">$<%= parseFloat(product.price).toFixed(2)  %> </span>
                    <span class="old-price">$<%= parseFloat(product.oldprice).toFixed(2)  %></span>
                  </div>
                </div>
              </div>
            </div>
            <% }) %>
            <% }else{ %>
            <h1 class="text-center">No Products Found</h1>
            <% } %>
          </div>
        </div>
        <% }else{ %>
        <h1 style="text-align: center;padding: 25%;">No Products Found in this <%= title  %> Category</h1>
        <% } %>
      </div>
      <div class="col-lg-3">
        <div class="sidebar-wrapper sidebar-wrapper-mr1">
          <% if(allcategory){ %>
          <div class="sidebar-widget sidebar-widget-wrap sidebar-widget-padding-1 mb-20">
            <h4 class="sidebar-widget-title">Categories </h4>
            <div class="sidebar-categories-list">
              <ul>
                <% allcategory.forEach(cat => { %>
                <li><a href="/shop/category/<%= cat.slug  %>"><%= cat.title  %> </a></li>
                <% }) %>
              </ul>
            </div>
          </div>
          <% } %>
          <div class="sidebar-widget sidebar-widget-wrap slidebar-product-wrap-2 sidebar-widget-padding-5 text-center mb-20">
            <div class="slidebar-product-content-2 text-center">
              <h3>FACEMASK</h3>
              <h2>Search Lab N95 Face Mask</h2>
            </div>
            <div class="slidebar-product-img-2 text-center">
              <a href="product-details.html"><img src="/images/product/product-banner-4.png" alt=""></a>
              <div class="slidebar-pro-badge slidebar-pro-badge-position1">
                <h3>
                  <span>12%</span>
                  Off
                </h3>
              </div>
            </div>
            <div class="btn-style-1">
              <a class="font-size-14 btn-1-padding-4" href="product-details.html">Shop now </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>